<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.10/index.global.min.js'></script> -->
    <!-- <script src='https://cdn.jsdelivr.net/npm/@fullcalendar/web-component@6.1.10/index.global.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.10/index.global.min.js'></script> -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <title>Carbon-Monox</title>

    <style>
      .container {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
      }

      #chart {
        width: 1000px;
        height: auto;
        align-self: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="controls">
        <form onsubmit="submitDate(event)">
          <div class="row">
            <div class="col-sm-12" align="center">
              <label for="start_date">Start Date</label>
              <input id="start_date" type="datetime-local" name="start_date" />
            </div>
            <div class="col-sm-12" align="center">
              <label for="end_date">End Date</label>
              <input id="end_date" type="datetime-local" name="end_date" />
            </div>
            <div class="col-sm-12" align="center">
              <!-- <label for="submitDate">Submit</label> -->
              <input type="submit" />
            </div>
          </div>
        </form>
      </div>
      <div id="chart"></div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript">

      function get_chart(start_date, end_date) {
        const myHeaders = new Headers();
        myHeaders.append("Accept", "application/json");

        const requestOptions = {
          method: "GET",
          headers: myHeaders,
          redirect: "follow",
        };

        fetch(
          `/graph/generate?start_date=${start_date}&end_date=${start_date}&graph_type=Bar`,
          requestOptions
        )
          .then((response) => response.text())
          .then((result) => {
            document.getElementById("chart").innerHtml=result
          })
          .catch((error) => console.error(error));
      }


      function submitDate(event) {
        event.preventDefault();

        start_date=event.target["start_date"].value;
        end_date=event.target["end_date"].value;

        get_chart(start_date, end_date)
      }
    </script>
  </body>
</html>
